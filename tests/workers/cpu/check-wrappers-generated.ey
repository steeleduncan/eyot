/*
  This originally failed because forward decls for wrappers were not generated
*/
fn double(val f32) f32 {
   return 2.0f * val 
}

struct Foo {
  cpu fn run() {
    let w = cpu double
    send(w, [f32] { 1.0, 2.0, 3.0 })
    for val: drain(w) {
      print_ln("val = ", val)
    }
  }
}

cpu fn main() {
    let f = Foo {}
    f.run()
}